"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[350],{1366:(n,i,e)=>{e.r(i),e.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>t,toc:()=>c});var s=e(4848),r=e(8453);const o={sidebar_position:7},a="S\u1eed d\u1ee5ng Push Notification trong React Native",t={id:"push-notification",title:"S\u1eed d\u1ee5ng Push Notification trong React Native",description:"Setup Firebase",source:"@site/docs/push-notification.md",sourceDirName:".",slug:"/push-notification",permalink:"/react-native/push-notification",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"S\u1eed d\u1ee5ng custom local font trong React Native",permalink:"/react-native/local-font-usage"},next:{title:"C\u1ea5u h\xecnh Deeplink trong React Native",permalink:"/react-native/deeplink"}},d={},c=[{value:"Setup Firebase",id:"setup-firebase",level:2},{value:"C\xe0i \u0111\u1eb7t th\u01b0 vi\u1ec7n",id:"c\xe0i-\u0111\u1eb7t-th\u01b0-vi\u1ec7n",level:2},{value:"T\u1ea1o h\xe0m x\u1eed l\xfd Push Notification",id:"t\u1ea1o-h\xe0m-x\u1eed-l\xfd-push-notification",level:2},{value:"Test push notification",id:"test-push-notification",level:2}];function l(n){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"s\u1eed-d\u1ee5ng-push-notification-trong-react-native",children:"S\u1eed d\u1ee5ng Push Notification trong React Native"})}),"\n",(0,s.jsx)(i.h2,{id:"setup-firebase",children:"Setup Firebase"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["V\xe0o trang: ",(0,s.jsx)(i.a,{href:"https://console.firebase.google.com/",children:"https://console.firebase.google.com/"})]}),"\n",(0,s.jsx)(i.li,{children:"T\u1ea1o Project"}),"\n",(0,s.jsx)(i.li,{children:"Sau khi t\u1ea1o project xong, ta t\u1ea1o App Android"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708997332632",src:e(425).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Trong \u0111\xf3:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Android package name"}),": t\xean android package, c\xf3 d\u1ea1ng nh\u01b0 ",(0,s.jsx)(i.em,{children:"com.taskmanagementapp"})," (ta c\xf3 th\u1ec3 t\xecm th\u1ea5y t\xean n\xe0y trong file MainApplication.kt)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708997462513",src:e(5241).A+"",width:"1910",height:"1052"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708998593922",src:e(2481).A+"",width:"1909",height:"884"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Ti\u1ebfp theo, c\u1ea5u h\xecnh SHA certificate tr\xean firebase b\u1eb1ng c\xe1ch g\xf5 l\u1ec7nh sau \u1edf project:","\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:"cd android\n./gradlew signingReport\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708998381624",src:e(2837).A+"",width:"1645",height:"958"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708998852650",src:e(3597).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708998888659",src:e(4771).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Ti\u1ebfp theo, t\u1ea3i file ",(0,s.jsx)(i.strong,{children:"google-services.json"})," v\xe0 \u0111\u01b0a file \u0111\xf3 v\xe0o th\u01b0 m\u1ee5c ",(0,s.jsx)(i.strong,{children:"android/app"}),":"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708999154166",src:e(4061).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708999109246",src:e(4574).A+"",width:"357",height:"571"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["V\xe0o file ",(0,s.jsx)(i.strong,{children:"/android/build.gradle"})," v\xe0 th\xeam d\xf2ng sau:"]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-gradle",children:"buildscript {\n  dependencies {\n    // ... other dependencies\n    // NOTE: if you are on react-native 0.71 or below, you must not update\n    //       the google-services plugin past version 4.3.15 as it requires gradle >= 7.3.0\n    classpath 'com.google.gms:google-services:4.4.1'\n    // Add me --- /\\\n  }\n}\n"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["V\xe0o file ",(0,s.jsx)(i.strong,{children:"/android/app/build.gradle"})," v\xe0 th\xeam d\xf2ng sau:"]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-gradle",children:"apply plugin: 'com.android.application'\napply plugin: 'com.google.gms.google-services' // <- Add this line\n"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Cu\u1ed1i c\xf9ng, ta enable Cloud Messaging API Server Key trong Firebase:"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708999691207",src:e(1427).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708999892759",src:e(8636).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1708999935459",src:e(5111).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"V\xe0 gi\u1edd ta \u0111\xe3 c\xf3 Server Key:"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1709000008947",src:e(5592).A+"",width:"1920",height:"1080"})}),"\n",(0,s.jsx)(i.h2,{id:"c\xe0i-\u0111\u1eb7t-th\u01b0-vi\u1ec7n",children:"C\xe0i \u0111\u1eb7t th\u01b0 vi\u1ec7n"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-bash",children:"npm install @react-native-firebase/app @react-native-firebase/messaging\n"})}),"\n",(0,s.jsx)(i.h2,{id:"t\u1ea1o-h\xe0m-x\u1eed-l\xfd-push-notification",children:"T\u1ea1o h\xe0m x\u1eed l\xfd Push Notification"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:["T\u1ea1o file ",(0,s.jsx)(i.strong,{children:"utils/push-notification.util.ts"}),":"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["H\xe0m ",(0,s.jsx)(i.strong,{children:"getFCMToken()"}),": M\xe3 th\xf4ng b\xe1o FCM l\xe0 m\u1ed9t chu\u1ed7i duy nh\u1ea5t \u0111\u01b0\u1ee3c t\u1ea1o b\u1edfi FCM v\xe0 \u0111\u01b0\u1ee3c g\u1eafn v\u1edbi m\u1ed7i thi\u1ebft b\u1ecb di \u0111\u1ed9ng \u0111\xe3 c\xe0i \u0111\u1eb7t \u1ee9ng d\u1ee5ng c\u1ee7a b\u1ea1n. H\xe0m ",(0,s.jsx)(i.code,{children:"getFCMToken()"})," c\xf3 ch\u1ee9c n\u0103ng l\u1ea5y m\xe3 th\xf4ng b\xe1o FCM t\u1eeb thi\u1ebft b\u1ecb di \u0111\u1ed9ng hi\u1ec7n t\u1ea1i. M\xe3 th\xf4ng b\xe1o n\xe0y c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 x\xe1c \u0111\u1ecbnh m\u1ed9t thi\u1ebft b\u1ecb c\u1ee5 th\u1ec3 v\xe0 g\u1eedi th\xf4ng b\xe1o t\u1eeb m\xe1y ch\u1ee7 c\u1ee7a b\u1ea1n \u0111\u1ebfn thi\u1ebft b\u1ecb \u0111\xf3 th\xf4ng qua FCM."]}),"\n",(0,s.jsxs)(i.li,{children:["H\xe0m ",(0,s.jsx)(i.strong,{children:"requestUserPermission()"})," \u0111\u1ec3 g\u1eedi y\xeau c\u1ea7u \u0111\u1ebfn user xem h\u1ecd c\xf3 cho ph\xe9p th\xf4ng b\xe1o c\u1ee7a app \u0111\u01b0\u1ee3c b\u1eadt hay kh\xf4ng."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-ts",children:'import AsyncStorage from "@react-native-async-storage/async-storage";\nimport messaging from "@react-native-firebase/messaging";\nimport { EStorageKey } from "@src/constants/enum";\nimport { PermissionsAndroid, Platform } from "react-native";\n\nconst getFCMToken = async () => {\n  const currentFCMToken = await AsyncStorage.getItem(EStorageKey.FCM_TOKEN);\n  console.log("Current FCM Token: ", currentFCMToken);\n\n  if (!currentFCMToken) {\n    try {\n      const newFCMToken = await messaging().getToken();\n      console.log("New FCM Token: ", newFCMToken);\n      await AsyncStorage.setItem(EStorageKey.FCM_TOKEN, newFCMToken);\n    } catch (error) {\n      console.log("Error when getting new FCM Token: ", error);\n    }\n  }\n};\n\nexport async function requestUserPermission() {\n  if (Platform.OS == "android" && Platform.Version >= 33) {\n    const granted = await PermissionsAndroid.request(\n      PermissionsAndroid.PERMISSIONS.POST_NOTIFICATIONS\n    );\n    if (granted === PermissionsAndroid.RESULTS.GRANTED) {\n      console.log("Notification permission is granted");\n      getFCMToken();\n    } else {\n      console.log("Notification permission is denied");\n    }\n  } else {\n    const authStatus = await messaging().requestPermission();\n    const enabled =\n      authStatus === messaging.AuthorizationStatus.AUTHORIZED ||\n      authStatus === messaging.AuthorizationStatus.PROVISIONAL;\n\n    if (enabled) {\n      console.log("Notification permission is denied");\n      getFCMToken();\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["V\xe0o file ",(0,s.jsx)(i.strong,{children:"TaskManagementApp/android/app/src/main/AndroidManifest.xml"})," \u0111\u1ec3 c\u1ea5u h\xecnh c\xe1c permission tr\xean Android:"]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-xml",children:'<manifest xmlns:android="http://schemas.android.com/apk/res/android">\n  <uses-permission android:name="android.permission.INTERNET"/>\n  <uses-permission android:name="android.permission.ACCEPT_HANDOVER" />\n  <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />\n  <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />\n  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />\n  <uses-permission android:name="android.permission.ACCESS_MEDIA_LOCATION" />\n  <uses-permission android:name="android.permission.ACTIVITY_RECOGNITION" />\n  <uses-permission android:name="com.android.voicemail.permission.ADD_VOICEMAIL" />\n  <uses-permission android:name="android.permission.ANSWER_PHONE_CALLS" />\n  <uses-permission android:name="android.permission.BLUETOOTH_ADVERTISE" />\n  <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />\n  <uses-permission android:name="android.permission.BLUETOOTH_SCAN" />\n  <uses-permission android:name="android.permission.BODY_SENSORS" />\n  <uses-permission android:name="android.permission.BODY_SENSORS_BACKGROUND" />\n  <uses-permission android:name="android.permission.CALL_PHONE" />\n  <uses-permission android:name="android.permission.CAMERA" />\n  <uses-permission android:name="android.permission.GET_ACCOUNTS" />\n  <uses-permission android:name="android.permission.NEARBY_WIFI_DEVICES" />\n  <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />\n  <uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" />\n  <uses-permission android:name="android.permission.READ_CALENDAR" />\n  <uses-permission android:name="android.permission.READ_CALL_LOG" />\n  <uses-permission android:name="android.permission.READ_CONTACTS" />\n  <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />\n  <uses-permission android:name="android.permission.READ_MEDIA_AUDIO" />\n  <uses-permission android:name="android.permission.READ_MEDIA_IMAGES" />\n  <uses-permission android:name="android.permission.READ_MEDIA_VIDEO" />\n  <uses-permission android:name="android.permission.READ_MEDIA_VISUAL_USER_SELECTED" />\n  <uses-permission android:name="android.permission.READ_PHONE_NUMBERS" />\n  <uses-permission android:name="android.permission.READ_PHONE_STATE" />\n  <uses-permission android:name="android.permission.READ_SMS" />\n  <uses-permission android:name="android.permission.RECEIVE_MMS" />\n  <uses-permission android:name="android.permission.RECEIVE_SMS" />\n  <uses-permission android:name="android.permission.RECEIVE_WAP_PUSH" />\n  <uses-permission android:name="android.permission.RECORD_AUDIO" />\n  <uses-permission android:name="android.permission.SEND_SMS" />\n  <uses-permission android:name="android.permission.USE_SIP" />\n  <uses-permission android:name="android.permission.UWB_RANGING" />\n  <uses-permission android:name="android.permission.WRITE_CALENDAR" />\n  <uses-permission android:name="android.permission.WRITE_CALL_LOG" />\n  <uses-permission android:name="android.permission.WRITE_CONTACTS" />\n  <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />\n  <application android:name=".MainApplication" android:label="@string/app_name" android:icon="@mipmap/ic_launcher" android:roundIcon="@mipmap/ic_launcher_round" android:allowBackup="false" android:theme="@style/AppTheme">\n    <activity android:name=".MainActivity" android:label="@string/app_name" android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|screenSize|smallestScreenSize|uiMode" android:launchMode="singleTask" android:windowSoftInputMode="adjustResize" android:exported="true">\n      <intent-filter>\n        <action android:name="android.intent.action.MAIN"/>\n        <category android:name="android.intent.category.LAUNCHER"/>\n      </intent-filter>\n      <intent-filter>\n        <action android:name="android.intent.action.VIEW"/>\n        <category android:name="android.intent.category.DEFAULT"/>\n        <category android:name="android.intent.category.BROWSABLE"/>\n        <data android:scheme="mytaskmanagementapp"/>\n      </intent-filter>\n    </activity>\n  </application>\n</manifest>\n'})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["File ",(0,s.jsx)(i.strong,{children:"App.tsx"}),":"]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-tsx",children:'import RootNavigator from "@src/navigators/RootNavigator";\nimport { requestUserPermission } from "@src/utils/push-notification.util";\nimport React, { useEffect } from "react";\n\nconst App = () => {\n  useEffect(() => {\n    requestUserPermission();\n  }, []);\n  return <RootNavigator />;\n};\n\nexport default App;\n'})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["C\u1ea5u h\xecnh v\u1eabn ch\u01b0a xong, xem ti\u1ebfp t\u1ea1i: ",(0,s.jsx)(i.a,{href:"./deeplink#s%E1%BB%AD-d%E1%BB%A5ng-deeplink-trong-push-notification",children:"S\u1eed d\u1ee5ng deeplink v\u1edbi Push Notification"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"test-push-notification",children:"Test push notification"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["V\xe0o trang web: ",(0,s.jsx)(i.a,{href:"https://testfcm.com/",children:"https://testfcm.com/"})]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{alt:"1709000581548",src:e(839).A+"",width:"1910",height:"1086"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Trong \u0111\xf3:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Server Key"}),": l\u1ea5y \u1edf trong firebase, xem \u1ea3nh tr\xean"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"FCM Registration Token"}),": token c\u1ee7a m\xe1y \u0111\u1ec3 g\u1eedi notification \u0111\u1ebfn"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Title"}),": ti\xeau \u0111\u1ec1 c\u1ee7a notification"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Body"}),": ph\u1ea7n n\u1ed9i dung th\xf4ng b\xe1o"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Icon URL"}),": icon c\u1ee7a app tr\xean thanh th\xf4ng b\xe1o"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Data"}),": d\u1eef li\u1ec7u g\u1eedi \u0111\u1ebfn t\u1eeb th\xf4ng b\xe1o"]}),"\n"]}),"\n"]}),"\n"]})]})}function m(n={}){const{wrapper:i}={...(0,r.R)(),...n.components};return i?(0,s.jsx)(i,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},425:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708997332632-4d3ccd666c9e1d5966d78bdd2efda367.png"},5241:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708997462513-706463fcdce2cfbc37d60cfa0de47f07.png"},2837:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708998381624-ab1c1bc9d98f3cecacccb729d301160a.png"},2481:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708998593922-ab16d6b01be8a643b5c5397228e843c8.png"},3597:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708998852650-d9cfbf2ac669c07e13908e1b9b67e617.png"},4771:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708998888659-a65730dd2a696f5b5e9622e664d51eff.png"},4574:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708999109246-996a72b0a3c3e7afe46f0e1b8907d02c.png"},4061:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708999154166-1c1868537674decda042cd5f46e3bec2.png"},1427:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708999691207-3e3b8927ed0581316b8cb48d8dd3074e.png"},8636:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708999892759-14ba1f062d4e855c08126152346c5378.png"},5111:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1708999935459-a1ef4cb65e978b951b68e024b87e6cc4.png"},5592:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1709000008947-e7513412f8512c991e2284688007d5f5.png"},839:(n,i,e)=>{e.d(i,{A:()=>s});const s=e.p+"assets/images/1709000581548-30a6b62ce6dc516589ae12c8843d8742.png"},8453:(n,i,e)=>{e.d(i,{R:()=>a,x:()=>t});var s=e(6540);const r={},o=s.createContext(r);function a(n){const i=s.useContext(o);return s.useMemo((function(){return"function"==typeof n?n(i):{...i,...n}}),[i,n])}function t(n){let i;return i=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),s.createElement(o.Provider,{value:i},n.children)}}}]);